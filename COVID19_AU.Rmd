---
title: "COVID-19 Progression: Australian Data Only"
date: "`r paste('Last Updated:', format(Sys.time(), '%d-%B-%Y %H:%M'), '(UTC+9:30)')`"
output: 
  html_document: 
    code_folding: hide
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE, warning = FALSE,
  fig.align = "center"
)
```

```{r packages}
library(tidyverse)
library(rlang)
library(lubridate)
library(scales)
library(ggrepel)
library(glue)
library(rvest)
library(pander)
library(plotly)
library(QuantTools)
panderOptions("big.mark", ",")
panderOptions("table.split.table", Inf)
panderOptions("table.style", "rmarkdown")
panderOptions("missing", "")
theme_set(theme_bw())
```


```{r ausStates}
auStates <- c(
  ACT = "Australian Capital Territory",
  QLD = "Queensland",
  NSW = "New South Wales",
  VIC = "Victoria",
  SA = "South Australia",
  WA = "Western Australia",
  NT = "Northern Territory",
  TAS = "Tasmania"
)
```

# Data Sources

```{r getCovidTable}
getCovidTable <- function(
  state = c("ACT", "QLD", "NSW", "VIC", "SA", "WA", "NT", "TAS"),
  type = c("cases", "recoveries", "deaths", "active-cases", "tests"),
  .state_full = auStates
){
  
  state <- match.arg(state)
  
  type <- match.arg(type)
  type_name <- c(
    cases = "confirmed",
    recoveries = "recovered",
    deaths = "deaths",
    `active-cases` = "active",
    tests = "tests"
  )[[type]]
  col_name <- c(
    cases = "CASES",
    recoveries = "RECOV",
    deaths = "DEATHS",
    `active-cases` = "ACTIVE",
    tests = "TESTS"
  )[[type]]
  
  url <- glue("https://covidlive.com.au/report/daily-{type}/{str_to_lower(state)}")
  url %>%
    read_html() %>%
    html_nodes("body") %>%
    xml_find_all(
      glue("//table[contains(@class, 'DAILY-{str_to_upper(type)}')]")
    ) %>% 
    html_table() %>%
    .[[1]] %>%
    as_tibble() %>%
    dplyr::select(date = DATE, !!sym(type_name) := !!sym(col_name)) %>%
    separate(date, into = c("day", "month")) %>%
    mutate(
      year = year(today()),
      date = paste(year, month, day, sep = "-"),
      date = parse_date_time(date, orders = "%Y-%B-%d"),
      date = ymd(date),
      State = .state_full[str_to_upper(state)],
      Country = "Australia"
    ) %>%
    mutate_at(
      .vars = type_name, 
      .funs = function(x){as.integer(str_remove_all(x, ","))}
    ) %>%
    dplyr::select(State, Country, date, !!sym(type_name)) %>%
    arrange(date) 
}
```


```{r confirmed}
confirmed <- names(auStates) %>%
  lapply(getCovidTable, type = "cases") %>%
  bind_rows()
```

```{r recovered}
recovered <- names(auStates) %>%
  lapply(getCovidTable, type = "recoveries") %>%
  bind_rows()
```

```{r deaths}
deaths <- names(auStates) %>%
  lapply(getCovidTable, type = "deaths") %>%
  bind_rows()
```

```{r active}
active <- names(auStates) %>%
  lapply(getCovidTable, type = "active-cases") %>%
  bind_rows()
```

```{r tests}
tested <- names(auStates) %>%
  lapply(getCovidTable, type = "tests") %>%
  bind_rows() %>%
  dplyr::filter(!is.na(tests))
```

```{r local}
getLocal <- function(  
  state = c("ACT", "QLD", "NSW", "VIC", "SA", "WA", "NT", "TAS"),  
  .state_full = auStates
){
  
  state <- match.arg(state)
  
  url <- glue("https://covidlive.com.au/report/daily-source-overseas/{str_to_lower(state)}")
  url %>%
    read_html() %>%
    html_nodes("body") %>%
    xml_find_all("//table[contains(@class, 'DAILY-SOURCE-OVERSEAS')]") %>% 
    html_table() %>%
    .[[1]] %>%
    as_tibble() %>%
    dplyr::select(date = DATE, local = LOCAL) %>%
    separate(date, into = c("day", "month")) %>%
    mutate(
      year = year(today()),
      date = paste(year, month, day, sep = "-"),
      date = parse_date_time(date, orders = "%Y-%B-%d"),
      date = ymd(date),
      State = .state_full[str_to_upper(state)],
      Country = "Australia",
      local = str_remove_all(local, ","),
      local = as.integer(local)
    ) %>%
    dplyr::select(State, Country, date, local) %>%
    arrange(date) 
}
local <- names(auStates) %>%
  lapply(getLocal) %>%
  bind_rows() %>%
  dplyr::filter(!is.na(local))
```


```{r dt}
dt <- max(confirmed$date)
if (hour(Sys.time()) < 9) dt <- dt -1
dt_char <- as.character(dt)
```



```{r vic_aged}
vic_aged <- "https://covidlive.com.au/report/daily-outbreaks-aged" %>%
  read_html() %>%
  html_nodes("body") %>%
  xml_find_all("//table[contains(@class, 'DAILY-OUTBREAKS-AGED')]") %>% 
    html_table() %>%
    .[[1]] %>%
    as_tibble() %>%
    dplyr::select(date = DATE, deaths = DEATHS, active = ACTIVE) %>%
    separate(date, into = c("day", "month")) %>%
    mutate(
      year = year(today()),
      date = paste(year, month, day, sep = "-"),
      date = parse_date_time(date, orders = "%Y-%b-%d"),
      date = ymd(date),
      State = "Victoria (Aged Care)",
      Country = "Australia"
    ) %>%
  arrange(date) %>%
  mutate(
    deaths = na_locf(deaths),
    active = na_locf(active),
    new = c(active[[1]], diff(active)),
    new = ifelse(new < 0, 0, new),
    confirmed = cumsum(new),
    recovered = confirmed - deaths - active,
    recovered = ifelse(recovered < 0, 0, recovered)
  ) %>%
  dplyr::filter(date <= dt) %>%
  dplyr::select(
    State, Country, date, deaths, confirmed, active, recovered
  ) 
```


Data for confirmed cases, active cases, recoveries and fatalities was exclusively sourced from [COVID LIVE](https://covidlive.com.au/).
Reliable data sources were extremely challenging prior to April and as such, minimal data is available from the early stages of the outbreak.

Similarly, data for the Victorian Aged Care outbreak was obtained from [data based on press releases](https://covidlive.com.au/report/daily-outbreaks-aged).



### International Data

International data and figures [can be viewed here](COVID19_Progression.html)


# Latest Australian Data {.tabset}

```{r ausPops}
ausPops <- tribble(
  ~State, ~Population,
  "New South Wales", 	8117976,
  "Victoria", 6629870,
  "Queensland", 5115451,
  "South Australia", 1756494,
  "Western Australia", 2630557,
  "Tasmania", 535500,
  "Northern Territory", 245562,
  "Australian Capital Territory", 428060
)
```

Australian State populations were taken from the [ABS Website](http://stat.data.abs.gov.au/Index.aspx?DataSetCode=ERP_QUARTERLY) and were accurate in Sept 2019.

- Using an estimated population size of `r comma(sum(ausPops$Population))`, the total percentage of the Australian population *confirmed as having been infected* currently sits at `r percent_format(accuracy = 0.01)(sum(dplyr::filter(confirmed, date == dt)$confirmed) / sum(ausPops$Population))`, or one person in every `r comma(round(sum(ausPops$Population) / sum(dplyr::filter(confirmed, date == dt)$confirmed), 0))`. 
- Within Victoria, that rises to one in every `r round(dplyr::filter(ausPops, State == "Victoria")$Population / dplyr::filter(confirmed, date == dt, State == "Victoria")$confirmed, 0)` having contracted the virus at some point


```{r latestAUTable}
confirmed %>% 
  left_join(recovered, by = c("State", "Country", "date")) %>%
  left_join(deaths, by = c("State", "Country", "date")) %>%
  left_join(active, by = c("State", "Country", "date")) %>%
  bind_rows(vic_aged) %>%
  dplyr::filter(
    date %in% c(dt, dt -1)
  ) %>%
  mutate(
    confirmed = case_when(
      State == "Victoria" ~ confirmed - dplyr::filter(., State == "Victoria (Aged Care)")$confirmed,
      TRUE ~ confirmed
    ),
    recovered = case_when(
      State == "Victoria" ~ recovered - dplyr::filter(., State == "Victoria (Aged Care)")$recovered,
      TRUE ~ recovered
    ),
    deaths = case_when(
      State == "Victoria" ~ deaths - dplyr::filter(., State == "Victoria (Aged Care)")$deaths,
      TRUE ~ deaths
    ),
    active = case_when(
      State == "Victoria" ~ active - dplyr::filter(., State == "Victoria (Aged Care)")$active,
      TRUE ~ active
    ),
    State = str_replace_all(State, "^Victoria$", "Victoria (Non-Aged Care)")
  ) %>%
  group_by(State) %>%
  mutate(
    Increase = c(NA, diff(confirmed)),
    `% Increase` = Increase / min(confirmed),
    recovered = c(NA, max(recovered)),
    deaths = c(NA, max(deaths)),
    active = c(NA, active[2])
  ) %>%
  ungroup() %>%
  pivot_wider(
    id_cols = State, 
    names_from = date, 
    values_from = c(confirmed, recovered, deaths, active, Increase, `% Increase`)
  ) %>%
  dplyr::select_if(function(x){sum(is.na(x)) <= 1}) %>%
  rename_all(
    str_remove_all, pattern = "confirmed_"
  ) %>%
  rename_all(str_remove_all, pattern = "_202[01].+") %>%
  arrange(State) %>%
  bind_rows(
    tibble(
      State = "National Total",
      "{as.character(dt -1)}" := sum(.[[as.character(dt -1)]]),
      "{dt_char}" := sum(.[[dt_char]]),
      Increase = sum(.$Increase),
      recovered = sum(.$recovered),
      deaths = sum(.$deaths),
      active = sum(.$active),
      `% Increase` = Increase / !!sym(as.character(dt - 1))
    )
  ) %>%
  mutate(
    `% Increase` = percent(`% Increase`, accuracy = 0.01),
    `Fatality Rate` = percent(deaths / !!sym(dt_char), accuracy = 0.1),
    `Recovery Rate` = percent(recovered / !!sym(dt_char), accuracy = 0.1),
  ) %>%
  rename(
    Fatalities = deaths,
    Recovered = recovered,
    `Currently Active` = active
  ) %>%
  dplyr::select(
    State, starts_with("20"), ends_with("Increase"), starts_with("Fatal"), starts_with("Recov"), `Currently Active`
  ) %>%
  pander(
    justify = "lrrrrrrrrr",
    caption = paste(
      "*Confirmed cases, fatalities and recoveries reported by each state at time of preparation.",
      "Given that the Victorian outbreak significantly impacted the Federally-run Aged Care facilities,", 
      "Victorian statistics are broken down into those for which the Andrews government is responsible (Non-Aged Care),", 
      "and those __for which the Morrisson government is reponsible (Aged Care)__.", 
      "Detailed statistics on Aged Care are not currently available for other states.*"
    ),
    emphasize.strong.rows = nrow(.)
  )
```

## Plot of Current Australian Values

```{r ausStatsCap}
ausStatsCap <- "*Current confirmed and recovered cases, along with fatalities for Australia only. Active cases are shown as confirmed cases excluding fatalities and those classed as recovered. Loess curves through all points are shown as continuous lines. Data is only shown from 1^st^ April 2020 as this was the first date of complete data being available. Recovered patient information was also sparse in the early stages of data collection, and as a result estimates of active infections will be a significant underestimate until 6^th^ April. In particular, QLD only began reporting recovered cases on this date. NSW followed a fortnight after this date and as such, only the most recent numbers can be considered as accurate. Below this plot, the same figures can be seen broken down by state.*"
```

```{r showAusStatsPlot, fig.height=6, fig.width=8, fig.cap=ausStatsCap}
ggplotly(
  confirmed %>%
    dplyr::filter(date <= dt) %>%
    left_join(deaths, by = c("State", "Country", "date")) %>%
    left_join(recovered, by = c("State", "Country", "date")) %>%
    left_join(active, by = c("State", "Country", "date")) %>%
    mutate_at(vars(confirmed, deaths, recovered, active), na_locf) %>%
    group_by(Country, date) %>%
    summarise_at(vars(confirmed, deaths, recovered, active), sum) %>%
    ungroup() %>%
    pivot_longer(
      cols = c(active, confirmed, deaths, recovered),
      names_to = "Status",
      values_to = "Total"
    ) %>%
    arrange(Status, date) %>%
    dplyr::filter(date > ymd("2020-04-01")) %>%
    mutate(
      Status = str_to_title(Status),
      Status = str_replace_all(Status, "Deaths", "Fatal"),
      Status = factor(Status, levels = c("Fatal", "Recovered", "Active"))
    ) %>%
    dplyr::filter(Total > 0) %>%
    rename_all(str_to_title) %>%
    dplyr::filter(Status != "Confirmed") %>%
    ggplot(aes(Date, Total, fill = Status)) +
    geom_col() +
    geom_line(
      data = . %>%
        group_by(Date) %>%
        summarise(
          Total = sum(Total)
        ) %>%
        mutate(Status = "Confirmed"),
      colour = "blue"
    ) +
    scale_fill_manual(
      values = c(
        Active = rgb(0, 0, 0),
        Confirmed = rgb(0, 0.3, 0.7),
        Fatal = rgb(0.8, 0.2, 0.2),
        Recovered = rgb(0.2, 0.7, 0.4)
      )
    ) +
    scale_x_date(expand = expansion(c(0, 0.03))) +
    scale_y_continuous(expand = expansion(c(0, 0.05))) +
    labs("Total Cases")
)
```



```{r plotStates, fig.width=10, fig.height=8, fig.cap="*Breakdown of individual states. Victorian recovered numbers began to be accurately reported from 22^nd^ March, with other states gradually providing this information. NSW/QLD recovered cases have only recently begun being reported and up until the most recent dates, recovered/active values were very approximate for these states. The extreme drop for NSW active cases in early June is a function of the changed reporting strategy implemented by NSW Health.*"}
ggplotly(
  confirmed %>%
    dplyr::filter(date <= dt) %>%    
    left_join(deaths, by = c("State", "Country", "date")) %>%
    left_join(recovered, by = c("State", "Country", "date")) %>%
    left_join(active, by = c("State", "Country", "date")) %>%
    mutate_at(vars(confirmed, deaths, recovered, active), na_locf) %>%
    dplyr::filter(
      date > ymd("2020-04-01"),
    ) %>%
    arrange(date) %>%
    left_join(ausPops) %>%
    pivot_longer(
      cols = c(confirmed, deaths, recovered, active),
      names_to = "status",
      values_to = "count"
    ) %>%
    dplyr::filter(
      count > 0,
      !(State %in% c("Queensland", "New South Wales") & status == "recovered" & date < ymd("2020-04-06")),
      !(State %in% c("South Australia") & status == "recovered" & date < ymd("2020-04-01")),    
      !(State %in% c("Tasmania") & status == "recovered" & date < ymd("2020-04-02")),
    ) %>%
    dplyr::filter(status != "confirmed") %>%
    mutate(
      rate = 1e6*count/Population,
      rate = round(rate, 2),
      status = str_replace(status, "deaths", "fatal") %>% str_to_title(),
      status = factor(status, levels = c("Fatal", "Recovered", "Active"))
    ) %>%
    rename_all(str_to_title) %>%
    ggplot(aes(Date, Rate, fill = Status, label = Count)) +
    geom_col() +
    geom_line(
      data = . %>%
        group_by(State, Date) %>%
        summarise(
          Rate = sum(Rate),
          Count = sum(Count)
        ) %>%
        mutate(Status = "Confirmed"),
      colour = "blue"
    ) +
    facet_wrap(~State, ncol = 4) + 
    scale_fill_manual(
      values = c(
        Active = rgb(0, 0, 0),
        Confirmed = rgb(0, 0.3, 0.7),
        Fatal = rgb(0.8, 0.2, 0.2),
        Recovered = rgb(0.2, 0.7, 0.4)
      )
    ) +
    scale_x_date(expand = expansion(c(0, 0.03))) +
    labs(y = "Rate (Cases / Million)")
)
```

## Daily New Cases

```{r plotDailyAusCases, fig.width=10, fig.height=8, fig.cap="*Daily new cases for each state shown against the 7-day (blue) and 14-day (black) averages. Days which the 7-day average is above the 14-day average are highlighted in red.*"}
ggplotly(
  confirmed %>%
    dplyr::filter(date <= dt) %>%    
    group_by(State) %>%
    mutate(daily = c(0, diff(confirmed))) %>%
    ungroup() %>%
    dplyr::filter(confirmed > 0) %>%
    mutate(
      daily = case_when(
        daily < 0 ~ 0,
        daily >= 0 ~ daily
      )
    ) %>%
    bind_rows(
      group_by(., date) %>%
        summarise(daily = sum(daily)) %>%
        ungroup() %>%
        mutate(State = "All States")
    ) %>%
    group_by(State) %>%
    mutate(
      MA = round(sma(daily, 7), 2),
      MA2 = round(sma(daily, 14), 2),
      `Above Average` = MA > MA2
    ) %>%
    dplyr::filter(date > "2020-03-01") %>%
    ggplot(aes(date, daily)) +
    geom_col(
      aes(fill = `Above Average`, colour = `Above Average`),
      data = . %>% dplyr::filter(!is.na(`Above Average`)),
      width = 1/2
    ) +
    geom_line(aes(y = MA), colour = "blue") +
    geom_line(aes(y = MA2), colour = "black") +
    facet_wrap(~State, scales = "free_y") +
    labs(
      x = "Date",
      y = "Daily New Cases",
      fill = "\nAbove\nAverage"
    ) +
    scale_fill_manual(values = c("white", rgb(1, 0.2, 0.2))) +
    scale_colour_manual(values = c("grey50", rgb(1, 0.2, 0.2))),
  tooltip = c(
    "date", "daily", "MA"
  )
)
```

## Australian Fatality Rate

```{r frOffset}
inc <- 6
icu <- 11
d <- 7
offset <- icu + d 
minDate <- "2020-04-20"
```

```{r frCP, echo=FALSE}
cp <- glue(
  "*Fatality rate for Australian cases as calculated using two methods.
  Where no offset is included, the rate shown is simply the number of fatalities divided by the total number of reported cases on the same date.
  When cases increase during a new outbreak, this will skew the fatality rate lower.
  An alternative is to use an offset based on the fact the the median time from infection to symptom onset is {inc} days, the median time from symptom onset to ICU admission is {icu} days, and the median time from ICU admission to mortality is {d} days.
  When using the offset, the fatality rate is calculated as the number of recorded fatalities on a given date, divided by by the number of cases from {offset} days ago.
  Whilst still flawed this may give a less biased estimate on the true fatality rate, and importantly, will always be higher than the alternative calculation.
  The intial fatality rate spiked above 30% during the intial outbreak under the offset approach, and as such, data is only shown after {format(ymd(minDate), '%d %b, %Y')}.
  All times used for estimation the offset were obtained from [here](https://wwwnc.cdc.gov/eid/article/26/6/20-0320_article)*"
)
```


```{r plotFR, fig.width=10, fig.height=6, fig.cap=cp}
list(
  confirmed %>%
    dplyr::filter(date <= dt) %>%    
    group_by(date) %>%
    summarise_at("confirmed", sum) %>%
    left_join(
      deaths %>%
        group_by(date) %>%
        summarise_at("deaths", sum)
    ) %>%
    dplyr::filter(
      date > minDate
    ) %>%
    mutate(
      fr = deaths / confirmed,
      type = "No Offset"
    ),
  confirmed %>%
    dplyr::filter(date <= dt) %>%    
    mutate(
      date = date + offset 
    ) %>%
    group_by(date) %>%
    summarise_at("confirmed", sum) %>%
    left_join(
      deaths %>%
        group_by(date) %>%
        summarise_at("deaths", sum) 
    ) %>%
    dplyr::filter(
      date > minDate
    ) %>%
    mutate(
      fr = deaths / confirmed,
      type = glue("Offset ({offset} days)")
    ) 
) %>%
  bind_rows() %>%
  ggplot(
    aes(date, fr, colour = type)
  ) +
  geom_line() +
  scale_x_date(
    expand = expansion(mult = 0, add = 0)
  ) +
  scale_y_continuous(label = percent) +
  labs(
    x = "Date",
    y = "Estimated Fatality Rate",
    colour = "Calculation"
  )
```


## Current Growth Factor

```{r cap4GF}
n <- 14
minCases <- 1
cp <- glue(
  "*Growth factor for each State/Territory. 
  __Values are calculated using only locally-acquired cases__.
  In order to try and minimise volatility a {n} day simple moving average was used, in contrast to the 5 day average as advocated [here](https://www.abc.net.au/news/2020-04-10/coronavirus-data-australia-growth-factor-covid-19/12132478).
  This enables assessment of the growth factor over an entire quarantine period.
  This value becomes volatile when daily new cases approach zero as is commonly observed in small populations, and at the end stages of an outbreak. 
  As a result, values are only shown when the {n}-day average of new __locally acquired cases__ exceeds {minCases}.*"
)
```


```{r plotGF, fig.width=10, fig.height=8, fig.cap=cp}
gf <- list(
  local %>%
    dplyr::filter(date <= dt) %>%    
    arrange(date) %>%
    group_by(State) %>%
    mutate(
      new = c(0, diff(local)),
      new_ma = sma(new, n)
    ) %>%
    dplyr::filter(local > 0, !is.na(new_ma)) %>%
    mutate(
      R = c(NA, new_ma[-1] / new_ma[-n()]),
      R = case_when(
        is.nan(R) ~ NA_real_,
        new_ma < minCases ~ NA_real_,
        TRUE ~ R
      )
    ) %>%
    ungroup() %>%
    arrange(State),
  local %>%
    dplyr::filter(date <= dt) %>%
    arrange(date) %>%
    group_by(Country, date) %>%
    summarise_at(vars(local), sum) %>%
    ungroup() %>%
    mutate(
      new = c(0, diff(local)),
      new_ma = sma(new, n)
    ) %>%
    dplyr::filter(local > 0, !is.na(new_ma)) %>%
    mutate(
      R = c(NA, new_ma[-1] / new_ma[-n()]),
      R = case_when(
        is.nan(R) ~ NA_real_,
        new_ma < minCases ~ NA_real_,
        TRUE ~ R
      ),
      State = "All States"
    ) %>%
    arrange(State)
) %>%
  bind_rows() %>%
  # dplyr::filter(date > ymd("2020-03-01")) %>%
  ggplot(aes(date, R, colour = State)) +
  geom_ribbon(aes(ymin = 1, ymax = R), alpha = 0.1) +
  geom_hline(yintercept = 1) +
  geom_label(
    aes(label = R),
    data = . %>%
      dplyr::filter(date == max(date), !is.na(R)) %>%
      mutate(R = round(R, 2), date = date + 1),
    fill = rgb(1, 1, 1, 0.3),
    show.legend = FALSE,
    nudge_y = 0.3,
    size = 4
  ) +
  labs(
    x = "Date", y = "Growth Factor"
  ) +
  facet_wrap(~State, scales = "free_x") +
  theme(legend.position = "none") +
  coord_cartesian(ylim = c(0.5, 1.8))#2.1))
gf
```

The current `r n` day growth factor is `r round(dplyr::filter(gf$data, date == max(date), State == "All States")$R, 2)` which gives `r ifelse(dplyr::filter(gf$data, date == max(date), State == "All States")$R > 1, "**considerable cause for concern.**", "some degree of confidence that the spread of infections is relatively under control")`.


## Testing Within Each State


```{r propTest}
tested %>% 
  left_join(confirmed, by = c("State", "Country", "date") ) %>%
  dplyr::filter(date == dt) %>%
  left_join(ausPops,  by = "State") %>%
  bind_rows(
    tibble(
      State = "National Total",
      date = dt,
      Population = sum(.$Population, na.rm = TRUE),
      confirmed = sum(.$confirmed, na.rm = TRUE),
      tests = sum(.$tests, na.rm = TRUE)
    )
  ) %>%
  mutate(
    `Tests / '000` = round(1e3 * tests / Population, 2),
    Positive = confirmed / tests,
    Negative = 1 - Positive,
    isTotal = grepl("Total", State)
  ) %>%
  dplyr::select(
    State, Population,
    Confirmed = confirmed,
    Tests = tests, 
    contains("000"), 
    ends_with("ive"),
    isTotal
  ) %>%
  arrange(isTotal, desc(`Tests / '000`)) %>%
  dplyr::select(-isTotal) %>%
  dplyr::rename(
    `% Positive Tests` = Positive,
    `% Negative Tests` = Negative
  ) %>%
  mutate_at(
    vars(starts_with("%")), percent, accuracy = 0.01
  ) %>%
  pander(
    justify = "lrrrrrr",
    missing = "",
    caption = glue(
      "*COVID-19 testing scaled by state population size.
      Confirmed cases are assumed to be the tests returning a positive result.
      The current numbers available for some states are a lower limit, and as such, the proportion of the population tested is likely to be higher, as is the proportion of tests returning a negative result.*"
    ),
    emphasize.strong.rows = nrow(.)
  )
```



# R Session Information

```{r sessionInfo, echo=FALSE}
pander(sessionInfo())
```

